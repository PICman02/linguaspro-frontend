 /**  * Utilidades de Autenticação  * Funções auxiliares para gerenciar estado de autenticação  */  class AuthManager {  /**   * Guardar dados do utilizador autenticado   */  static setUser(userData) {   localStorage.setItem('user', JSON.stringify(userData));  }   /**   * Obter dados do utilizador autenticado   */  static getUser() {   const user = localStorage.getItem('user');   return user ? JSON.parse(user) : null;  }   /**   * Remover dados do utilizador   */  static removeUser() {   localStorage.removeItem('user');  }   /**   * Verificar se utilizador está autenticado   */  static isLoggedIn() {   return apiClient.isAuthenticated() && this.getUser() !== null;  }   /**   * Verificar se utilizador tem role específica   */  static hasRole(role) {   const user = this.getUser();   return user && user.role === role;  }   /**   * Fazer logout   */  static async logout() {   try {    await apiClient.logout();   } finally {    this.removeUser();    window.location.href = '/login.html';   }  }   /**   * Proteger rota - redirecionar se não autenticado   */  static protectRoute(requiredRole = null) {   if (!this.isLoggedIn()) {    window.location.href = '/login.html';    return false;   }    if (requiredRole && !this.hasRole(requiredRole)) {    window.location.href = '/index.html';    return false;   }    return true;  }   /**   * Atualizar role do utilizador   */  static setUserRole(role) {   const user = this.getUser();   if (user) {    user.role = role;    this.setUser(user);   }  } }  // Verificar se token foi renovado automaticamente ao carregar página document.addEventListener('DOMContentLoaded', () => {  if (apiClient.isAuthenticated()) {   // Token válido, usuário está logado  } else if (apiClient.getToken()) {   // Token expirado, tentar renovar   apiClient.refreshToken().catch(() => {    // Falha ao renovar, redirecionar para login    if (window.location.pathname !== '/login.html') {     AuthManager.logout();    }   });  } });  // Exportar para módulos if (typeof module !== 'undefined' && module.exports) {  module.exports = { AuthManager }; }   